<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Book Request Form</title>
  </head>
  <body>
    <!-- CUSTOM STYLES FOR FORM -->
    <style>
      /* Custom popup alert */
      #customAlertBox {
        display: none;
        position: fixed;
        top: 30%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        border: 2px solid #0070d2;
        border-radius: 12px;
        padding: 25px 30px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        z-index: 9999;
        text-align: center;
        max-width: 500px;
        width: 90%;
      }

      #customAlertMsg {
        margin-bottom: 15px;
        font-size: 16px;
        color: #333;
      }

      #customAlertBox button {
        background-color: #0070d2;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
      }

      #customAlertBox button:hover {
        background-color: #005bb5;
      }

      #customAlertOverlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 9998;
      }
    </style>

    <!-- CUSTOM ALERT POPUP HTML -->
    <div id="customAlertBox">
      <div id="customAlertMsg"></div>
      <button onclick="closeAlert()">OK</button>
    </div>

    <!-- THE FORM STARTS HERE -->
    <form
      id="webToLeadForm"
      action="https://webto.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8"
      method="POST"
    >
      <input name="oid" type="hidden" value="00D8c00000176n8" />
      <input
        name="retURL"
        type="hidden"
        value="https://promising-pages.org/book-request-submitted/"
      />

      <em>*Indicates a field is required</em><br />
      <label for="first_name">First Name* </label
      ><input
        id="first_name"
        maxlength="40"
        name="first_name"
        required=""
        size="20"
        type="text"
      /><br />
      <label for="last_name">Last Name* </label
      ><input
        id="last_name"
        maxlength="80"
        name="last_name"
        required=""
        size="20"
        type="text"
      /><br />
      <label for="email">Email* </label
      ><input
        id="email"
        maxlength="80"
        name="email"
        required=""
        size="20"
        type="text"
      /><br />
      <label for="company">Organization/School Name* </label
      ><input
        id="company"
        maxlength="80"
        name="company"
        required=""
        size="20"
        type="text"
      /><br />
      <label for="title">Title </label
      ><input
        id="title"
        maxlength="40"
        name="title"
        size="20"
        type="text"
      /><br />
      <label for="phone">Phone* </label
      ><input
        id="phone"
        maxlength="40"
        name="phone"
        required=""
        size="20"
        type="text"
      /><br />
      Preferred Phone:
      <select title="Preferred Phone" name="00N8c00000G6A2B">
        <option value="">--None--</option>
        <option value="Home">Home</option>
        <option value="Work">Work</option>
        <option value="Mobile">Mobile</option>
        <option value="Other">Other</option>
      </select>

      <h3></h3>
      <h3>
        <b><label for="">Address Information</label></b>
      </h3>
      <label for="street">Street* </label
      ><textarea name="street" required=""></textarea><br />
      <label for="city">City* </label
      ><input
        id="city"
        maxlength="40"
        name="city"
        required=""
        size="20"
        type="text"
      /><br />
      <label for="state">State/Province* </label
      ><input
        id="state"
        maxlength="20"
        name="state"
        required=""
        size="20"
        type="text"
      /><br />
      <label for="zip">Zip Code* </label
      ><input
        id="zip"
        maxlength="20"
        name="zip"
        required=""
        size="20"
        type="text"
      /><br />
      <label for="country">Country* </label
      ><input
        id="country"
        maxlength="40"
        name="country"
        required=""
        size="20"
        type="text"
        value="United States"
      />

      <h3></h3>
      <h3>
        <b><label for="">Books Information</label></b>
      </h3>
      <b
        ><label for=""
          >Please provide the number of books for each category</label
        ></b
      ><br />
      Board Books (Birth - Pre-K):
      <input
        id="00N8c00000aEJnu"
        name="00N8c00000aEJnu"
        size="20"
        type="text"
      /><br />
      Picture Books (Pre-K - 2nd Grade):
      <input
        id="00N8c00000aEJnz"
        name="00N8c00000aEJnz"
        size="20"
        type="text"
      /><br />
      Early Chapter/Advanced Picture (2nd Grade - 4th Grade):
      <input
        id="00N8c00000aEJo9"
        name="00N8c00000aEJo9"
        size="20"
        type="text"
      /><br />
      Upper Chapter Books (4th Grade - 5th Grade):
      <input
        id="00N8c00000aEJoE"
        name="00N8c00000aEJoE"
        size="20"
        type="text"
      /><br />
      Middle School Books Requested (6th Grade - 8th Grade):
      <input
        id="00N8c00000aEJoJ"
        name="00N8c00000aEJoJ"
        size="20"
        type="text"
      /><br />
      High School Books Requested (9th Grade - 12th Grade):
      <input
        id="00N8c00000e09tp"
        name="00N8c00000e09tp"
        size="20"
        type="text"
      /><br />
      Adult Books (18 and Up):
      <input
        id="00N8c00000aEJoO"
        name="00N8c00000aEJoO"
        size="20"
        type="text"
      /><br />
      Religious Books:
      <input
        id="00N8c00000aEJoT"
        name="00N8c00000aEJoT"
        size="20"
        type="text"
      /><br />
      Activity Books:
      <input
        id="00N8c00000aEJod"
        name="00N8c00000aEJod"
        size="20"
        type="text"
      /><br />
      Free Bookmarks for Students:
      <input
        id="00N8c00000aEJoY"
        name="00N8c00000aEJoY"
        size="20"
        type="text"
      />

      <h3></h3>
      <h3>
        <b><label for="">Other Book Distribution Information</label></b>
      </h3>
      Anything else we should know about the books you are requesting?
      <textarea
        id="00N8c00000aEJon"
        name="00N8c00000aEJon"
        rows="3"
        wrap="soft"
      ></textarea
      ><br />
      How many children do you plan to serve with these books?* (Please enter
      numbers only, no text or number ranges)
      <input
        id="00N8c00000aEMWm"
        name="00N8c00000aEMWm"
        required=""
        size="20"
        type="text"
      /><br />
      What specifically will these books be used for? (Hold down the Ctrl button
      to select more than one option.)*<br />
      <select
        title="Book Use"
        multiple="multiple"
        name="00N8c00000aEMWr"
        required=""
      >
        <option value="Building Home Libraries">Building Home Libraries</option>
        <option value="Classroom Libraries">Classroom Libraries</option>
        <option value="School Library Support">School Library Support</option>
        <option value="Book Giveaway">Book Giveaway</option>
        <option value="Literacy or Curriculum Night/Fair">
          Literacy or Curriculum Night/Fair
        </option>
        <option value="Summer Reading/Summer Slide">
          Summer Reading/Summer Slide
        </option>
        <option value="Other">Other</option></select
      ><br />
      How many books do you plan to provide per child?* (Please enter numbers
      only, no text or number ranges)
      <input
        id="00N8c00000aEJos"
        name="00N8c00000aEJos"
        required=""
        size="20"
        type="text"
      /><br />

      What date would you like to pick up your books? Pick-up days are
      Monday-Thursday. (Please choose a date from the date picker)*
      <span class="dateInput dateOnlyInput">
        <input id="pickupDate" required type="date" /> </span
      ><br />

      What time would you prefer to pick up your books on the date you selected?
      Pick up times are between 9:30am-3:30pm.*
      <input
        required
        type="time"
        id="pickupTime"
        min="09:30"
        max="15:30"
      /><br />

      When is your expected book distribution date?*
      <input id="expectedDateInput" required type="date" /><br />

      Would you like to self-select your books or have them pre-boxed by
      Promising Pages staff?*
      <select
        id="00N8c00000aEJp2"
        title="Book Selection Type"
        name="00N8c00000aEJp2"
        required=""
      >
        <option value="">--None--</option>
        <option value="Self-Select">Self-Select</option>
        <option value="Pre-Boxed">Pre-Boxed</option>
      </select>

      <!-- Hidden fields to store formatted dates for Salesforce -->
      <input type="hidden" id="pickupHidden" name="00N8c00000aEJox" />
      <input type="hidden" id="pickupTimeHidden" name="00N8c00000e0Wwy" />
      <input type="hidden" id="expectedHidden" name="00N8c00000dxTkW" />

      <input
        id="lead_source"
        name="lead_source"
        required=""
        type="hidden"
        value="Web"
      />
      <input
        id="recordType"
        name="recordType"
        type="hidden"
        value="0128c000001e1kK"
      /><br />
      <input name="submit" type="submit" />
    </form>
    <!-- THE FORM ENDS HERE -->

    <!-- JAVASCRIPT FOR VALIDATION AND ALERTS -->
    <script>
      // Alert functions
      function showAlert(msg) {
        const box = document.getElementById("customAlertBox");
        const text = document.getElementById("customAlertMsg");
        text.textContent = msg;
        box.style.display = "block";

        // Add overlay in the background
        const overlay = document.createElement("div");
        overlay.id = "customAlertOverlay";
        document.body.appendChild(overlay);
      }

      function closeAlert() {
        const box = document.getElementById("customAlertBox");
        const overlay = document.getElementById("customAlertOverlay");

        box.style.display = "none";
        if (overlay) {
          overlay.remove();
        }
      }

      // Main validation script
      (function () {
        const form = document.getElementById("webToLeadForm");
        const pickupDate = document.getElementById("pickupDate");
        const pickupTime = document.getElementById("pickupTime");
        const pickupHidden = document.getElementById("pickupHidden");
        const pickupTimeHidden = document.getElementById("pickupTimeHidden");
        const expectedDateInput = document.getElementById("expectedDateInput");
        const expectedHidden = document.getElementById("expectedHidden");

        // Set minimum date to today
        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, "0");
        const dd = String(today.getDate()).padStart(2, "0");
        const todayStr = `${yyyy}-${mm}-${dd}`;
        pickupDate.setAttribute("min", todayStr);
        expectedDateInput.setAttribute("min", todayStr);

        // Validate pickup date (Monday-Thursday only, no past dates)
        function validatePickupDate() {
          const value = pickupDate.value;
          if (!value) return;

          // Only validate if the date format is complete
          if (value.length !== 10) return;

          const [year, month, day] = value.split("-").map(Number);

          // Make sure we have a valid year
          if (year < 1000) return;

          const chosen = new Date(year, month - 1, day, 12, 0, 0);

          // Check if date is in the past
          const todayMidnight = new Date(
            today.getFullYear(),
            today.getMonth(),
            today.getDate()
          );
          const chosenMidnight = new Date(year, month - 1, day);

          if (chosenMidnight < todayMidnight) {
            showAlert("Pick-up date must be today or in the future.");
            pickupDate.value = "";
            return;
          }

          // Check day of week (0=Sunday, 6=Saturday)
          const dayOfWeek = chosen.getDay();

          if (dayOfWeek === 0 || dayOfWeek === 5 || dayOfWeek === 6) {
            showAlert("Pick-up days are Monday through Thursday only.");
            pickupDate.value = "";
          }
        }

        pickupDate.addEventListener("change", validatePickupDate);
        pickupDate.addEventListener("blur", validatePickupDate);

        // Validate pickup time (9:30 AM - 3:30 PM)
        function validatePickupTime() {
          const timeVal = pickupTime.value;
          if (!timeVal) return;

          // Only validate if the time format is complete
          if (timeVal.length !== 5) return;

          const [hours, minutes] = timeVal.split(":").map(Number);
          const totalMinutes = hours * 60 + minutes;
          const minMinutes = 9 * 60 + 30; // 9:30 AM
          const maxMinutes = 15 * 60 + 30; // 3:30 PM

          if (totalMinutes < minMinutes || totalMinutes > maxMinutes) {
            showAlert("Pick-up time must be between 9:30 AM and 3:30 PM.");
            pickupTime.value = "";
          }
        }

        pickupTime.addEventListener("change", validatePickupTime);
        pickupTime.addEventListener("blur", validatePickupTime);

        // Format dates before submission
        form.addEventListener("submit", function (e) {
          const dateVal = pickupDate.value;
          const timeVal = pickupTime.value;

          if (!dateVal || !timeVal) {
            e.preventDefault();
            showAlert("Please select both pickup date and time.");
            return;
          }

          // Format pickup date and time for Salesforce
          const combined = new Date(`${dateVal}T${timeVal}`);
          const month = combined.getMonth() + 1;
          const day = combined.getDate();
          const year = combined.getFullYear();

          let hours = combined.getHours();
          const minutes = String(combined.getMinutes()).padStart(2, "0");
          const ampm = hours >= 12 ? "PM" : "AM";
          hours = hours % 12 || 12;

          // Set hidden field for pickup date/time combined
          pickupHidden.value = `${month}/${day}/${year}, ${hours}:${minutes} ${ampm}`;

          // Set hidden field for time only
          pickupTimeHidden.value = `${hours}:${minutes} ${ampm}`;

          // Format expected distribution date
          const expectedVal = expectedDateInput.value;
          if (expectedVal) {
            const [eyear, emonth, eday] = expectedVal.split("-");
            expectedHidden.value = `${emonth}/${eday}/${eyear}`;
          }
        });
      })();
    </script>
  </body>
</html>
