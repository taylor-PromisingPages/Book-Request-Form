<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Book Request Form - Promising Pages</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Open+Sans:wght@400;600&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: 'Open Sans', sans-serif;
        background: linear-gradient(135deg, #205E61 0%, #113868 100%);
        padding: 20px;
        line-height: 1.6;
      }

      .form-container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        overflow: hidden;
      }

      .form-header {
        background: linear-gradient(135deg, #205E61 0%, #113868 100%);
        color: white;
        padding: 50px 40px;
        text-align: center;
        position: relative;
      }

      .form-header::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 6px;
        background: linear-gradient(90deg, #F2AD52 0%, #FF9E7A 100%);
      }

      .form-header h1 {
        font-family: 'Montserrat', sans-serif;
        font-size: 36px;
        font-weight: 700;
        margin-bottom: 8px;
        letter-spacing: 0.5px;
      }

      .form-header .subtitle {
        font-family: 'Poppins', sans-serif;
        font-size: 16px;
        opacity: 0.95;
        margin-bottom: 16px;
      }

      .form-header .tagline {
        font-family: 'Poppins', sans-serif;
        font-size: 18px;
        font-weight: 500;
        font-style: italic;
        color: #F2AD52;
        margin-top: 12px;
      }

      .form-content {
        padding: 50px 40px;
      }

      .info-box {
        background: linear-gradient(135deg, #B9D9EB 0%, #e8f4f8 100%);
        border-left: 5px solid #205E61;
        padding: 24px;
        margin-bottom: 40px;
        border-radius: 12px;
        font-size: 14px;
        line-height: 1.7;
        box-shadow: 0 4px 12px rgba(32, 94, 97, 0.1);
      }

      .info-box strong {
        display: block;
        margin-bottom: 12px;
        color: #113868;
        font-family: 'Poppins', sans-serif;
        font-size: 16px;
        font-weight: 600;
      }

      .info-box a {
        color: #205E61;
        font-weight: 600;
        text-decoration: none;
        transition: all 0.3s ease;
      }

      .info-box a:hover {
        color: #F2AD52;
        text-decoration: underline;
      }

      .required-note {
        font-style: italic;
        color: #545454;
        margin-bottom: 40px;
        font-size: 14px;
      }

      .section-title {
        font-family: 'Montserrat', sans-serif;
        font-size: 24px;
        font-weight: 700;
        color: #113868;
        margin: 50px 0 24px 0;
        padding-bottom: 12px;
        border-bottom: 4px solid #F2AD52;
        position: relative;
      }

      .section-title::after {
        content: '';
        position: absolute;
        bottom: -4px;
        left: 0;
        width: 80px;
        height: 4px;
        background: #205E61;
      }

      .form-group {
        margin-bottom: 26px;
      }

      .form-group label {
        display: block;
        font-family: 'Poppins', sans-serif;
        font-weight: 600;
        color: #113868;
        margin-bottom: 8px;
        font-size: 14px;
      }

      .form-group input[type="text"],
      .form-group input[type="email"],
      .form-group input[type="date"],
      .form-group input[type="time"],
      .form-group select,
      .form-group textarea {
        width: 100%;
        padding: 14px 16px;
        border: 2px solid #B9D9EB;
        border-radius: 10px;
        font-size: 15px;
        font-family: 'Open Sans', sans-serif;
        transition: all 0.3s ease;
        background: white;
      }

      .form-group input[type="text"]:focus,
      .form-group input[type="email"]:focus,
      .form-group input[type="date"]:focus,
      .form-group input[type="time"]:focus,
      .form-group select:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: #205E61;
        box-shadow: 0 0 0 4px rgba(32, 94, 97, 0.1);
      }

      .form-group textarea {
        resize: vertical;
        min-height: 110px;
      }

      .form-group select[multiple] {
        min-height: 130px;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
      }

      .book-categories {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-top: 24px;
      }

      .book-input-group {
        display: flex;
        flex-direction: column;
      }

      .book-input-group label {
        font-family: 'Poppins', sans-serif;
        font-size: 13px;
        font-weight: 500;
        color: #545454;
        margin-bottom: 8px;
      }

      .book-input-group input {
        padding: 12px 14px;
        border: 2px solid #B9D9EB;
        border-radius: 10px;
        font-size: 14px;
        font-family: 'Open Sans', sans-serif;
        transition: all 0.3s ease;
      }

      .book-input-group input:focus {
        outline: none;
        border-color: #205E61;
        box-shadow: 0 0 0 4px rgba(32, 94, 97, 0.1);
      }

      .submit-btn {
        background: linear-gradient(135deg, #205E61 0%, #113868 100%);
        color: white;
        border: none;
        padding: 18px 60px;
        font-size: 17px;
        font-family: 'Montserrat', sans-serif;
        font-weight: 700;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 100%;
        margin-top: 40px;
        text-transform: uppercase;
        letter-spacing: 1px;
        box-shadow: 0 8px 20px rgba(17, 56, 104, 0.3);
      }

      .submit-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 30px rgba(17, 56, 104, 0.4);
        background: linear-gradient(135deg, #113868 0%, #205E61 100%);
      }

      .submit-btn:active {
        transform: translateY(-1px);
      }

      /* Custom Alert Styles */
      #customAlertBox {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        border-radius: 16px;
        padding: 35px;
        box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
        z-index: 9999;
        text-align: center;
        max-width: 450px;
        width: 90%;
        animation: slideIn 0.3s ease;
        border-top: 5px solid #F2AD52;
      }

      /* Force alert to appear in viewport center even in iframe */
      body.alert-open #customAlertBox {
        position: fixed;
        top: 50vh;
        left: 50%;
        transform: translate(-50%, -50%);
        margin: 0;
      }

      body.alert-open #customAlertOverlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translate(-50%, -60%);
        }
        to {
          opacity: 1;
          transform: translate(-50%, -50%);
        }
      }

      #customAlertMsg {
        margin-bottom: 24px;
        font-size: 16px;
        color: #113868;
        line-height: 1.6;
        font-family: 'Open Sans', sans-serif;
      }

      #customAlertBox button {
        background: linear-gradient(135deg, #205E61 0%, #113868 100%);
        color: white;
        border: none;
        padding: 12px 40px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 15px;
        font-family: 'Montserrat', sans-serif;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      #customAlertBox button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(32, 94, 97, 0.4);
      }

      #customAlertOverlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(17, 56, 104, 0.7);
        z-index: 9998;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      /* Helper text styling */
      .helper-text {
        font-weight: 600;
        margin-bottom: 20px;
        color: #545454;
        font-family: 'Poppins', sans-serif;
        font-size: 14px;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        body {
          padding: 10px;
        }

        .form-header {
          padding: 35px 25px;
        }

        .form-header h1 {
          font-size: 28px;
        }

        .form-header .tagline {
          font-size: 16px;
        }

        .form-content {
          padding: 35px 25px;
        }

        .form-row {
          grid-template-columns: 1fr;
        }

        .book-categories {
          grid-template-columns: 1fr;
        }

        .section-title {
          font-size: 22px;
          margin: 40px 0 20px 0;
        }

        .submit-btn {
          padding: 16px 40px;
          font-size: 16px;
        }
      }

      @media (max-width: 480px) {
        .form-header h1 {
          font-size: 24px;
        }

        .form-header .subtitle {
          font-size: 14px;
        }

        .form-header .tagline {
          font-size: 15px;
        }

        .form-content {
          padding: 25px 18px;
        }

        .info-box {
          padding: 18px;
          font-size: 13px;
        }

        .section-title {
          font-size: 20px;
          margin: 35px 0 18px 0;
        }

        #customAlertBox {
          padding: 28px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Custom Alert -->
    <div id="customAlertBox">
      <div id="customAlertMsg"></div>
      <button onclick="closeAlert()">OK</button>
    </div>

    <div class="form-container">
      <div class="form-header">
        <h1>Book Request Form</h1>
        <!-- <p class="subtitle">The Charlotte Area Book Bank</p>
        <p class="tagline">A life of opportunity starts with a love of reading and Access to Books</p> -->
      </div>

      <div class="form-content">
        <div class="info-box">
          <strong>Important Information:</strong>
          We do our best to fulfill every book request as quickly as possible. Please note that all orders are filled based on current book availability. For orders under 800 books, please allow up to 5 business days for fulfillment. For orders of 800 books or more, please allow up to 10 business days for fulfillment. If you have any questions or concerns, please contact Dana Powell, Operations Manager, at <a href="mailto:dana@promising-pages.org">dana@promising-pages.org</a>.
        </div>

        <p class="required-note">*Indicates a required field</p>

        <form
          id="webToLeadForm"
          action="https://webto.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8"
          method="POST"
          target="_parent"
        >
          <input name="oid" type="hidden" value="00D8c00000176n8" />
          <input name="retURL" type="hidden" value="https://promising-pages.org/book-request-submitted/" />
          <input name="lead_source" type="hidden" value="Web" />
          <input name="recordType" type="hidden" value="0128c000001e1kK" />
          
          <!-- Hidden fields for Salesforce -->
          <input type="hidden" id="pickupHidden" name="00N8c00000aEJox" />
          <input type="hidden" id="pickupTimeHidden" name="00N8c00000e0Wwy" />
          <input type="hidden" id="expectedHidden" name="00N8c00000dxTkW" />

          <h2 class="section-title">Contact Information</h2>

          <div class="form-row">
            <div class="form-group">
              <label for="first_name">First Name*</label>
              <input id="first_name" name="first_name" type="text" maxlength="40" required />
            </div>
            <div class="form-group">
              <label for="last_name">Last Name*</label>
              <input id="last_name" name="last_name" type="text" maxlength="80" required />
            </div>
          </div>

          <div class="form-group">
            <label for="email">Email Address*</label>
            <input id="email" name="email" type="email" maxlength="80" required />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="company">Organization/School Name*</label>
              <input id="company" name="company" type="text" maxlength="80" required />
            </div>
            <div class="form-group">
              <label for="title">Title</label>
              <input id="title" name="title" type="text" maxlength="40" />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="phone">Phone Number*</label>
              <input id="phone" name="phone" type="text" maxlength="40" required />
            </div>
            <div class="form-group">
              <label for="00N8c00000G6A2B">Preferred Phone Type</label>
              <select name="00N8c00000G6A2B">
                <option value="">--Select--</option>
                <option value="Home">Home</option>
                <option value="Work">Work</option>
                <option value="Mobile">Mobile</option>
                <option value="Other">Other</option>
              </select>
            </div>
          </div>

          <h2 class="section-title">Address Information</h2>

          <div class="form-group">
            <label for="street">Street Address*</label>
            <textarea name="street" id="street" required></textarea>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="city">City*</label>
              <input id="city" name="city" type="text" maxlength="40" required />
            </div>
            <div class="form-group">
              <label for="state">State/Province*</label>
              <input id="state" name="state" type="text" maxlength="20" required />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="zip">Zip Code*</label>
              <input id="zip" name="zip" type="text" maxlength="20" required />
            </div>
            <div class="form-group">
              <label for="country">Country*</label>
              <input id="country" name="country" type="text" maxlength="40" value="United States" required />
            </div>
          </div>

          <h2 class="section-title">Books Information</h2>

          <p class="helper-text">Please provide the number of books for each category:</p>

          <div class="book-categories">
            <div class="book-input-group">
              <label for="00N8c00000aEJnu">Board Books (Birth - Pre-K)</label>
              <input id="00N8c00000aEJnu" name="00N8c00000aEJnu" type="text" />
            </div>
            <div class="book-input-group">
              <label for="00N8c00000aEJnz">Picture Books (Pre-K - 2nd Grade)</label>
              <input id="00N8c00000aEJnz" name="00N8c00000aEJnz" type="text" />
            </div>
            <div class="book-input-group">
              <label for="00N8c00000aEJo9">Early Chapter/Advanced Picture (2nd - 4th Grade)</label>
              <input id="00N8c00000aEJo9" name="00N8c00000aEJo9" type="text" />
            </div>
            <div class="book-input-group">
              <label for="00N8c00000aEJoE">Upper Chapter Books (4th - 5th Grade)</label>
              <input id="00N8c00000aEJoE" name="00N8c00000aEJoE" type="text" />
            </div>
            <div class="book-input-group">
              <label for="00N8c00000aEJoJ">Middle School Books (6th - 8th Grade)</label>
              <input id="00N8c00000aEJoJ" name="00N8c00000aEJoJ" type="text" />
            </div>
            <div class="book-input-group">
              <label for="00N8c00000e09tp">High School Books (9th - 12th Grade)</label>
              <input id="00N8c00000e09tp" name="00N8c00000e09tp" type="text" />
            </div>
            <div class="book-input-group">
              <label for="00N8c00000aEJoO">Adult Books (18 and Up)</label>
              <input id="00N8c00000aEJoO" name="00N8c00000aEJoO" type="text" />
            </div>
            <div class="book-input-group">
              <label for="00N8c00000aEJoT">Religious Books</label>
              <input id="00N8c00000aEJoT" name="00N8c00000aEJoT" type="text" />
            </div>
            <div class="book-input-group">
              <label for="00N8c00000aEJod">Activity Books</label>
              <input id="00N8c00000aEJod" name="00N8c00000aEJod" type="text" />
            </div>
            <div class="book-input-group">
              <label for="00N8c00000aEJoY">Free Bookmarks for Students</label>
              <input id="00N8c00000aEJoY" name="00N8c00000aEJoY" type="text" />
            </div>
          </div>

          <h2 class="section-title">Distribution Details</h2>

          <div class="form-group">
            <label for="00N8c00000aEJon">Additional Information</label>
            <textarea id="00N8c00000aEJon" name="00N8c00000aEJon" rows="3" placeholder="Anything else we should know about the books you are requesting?"></textarea>
          </div>

          <div class="form-group">
            <label for="00N8c00000aEMWm">How many children do you plan to serve with these books?* (Numbers only)</label>
            <input id="00N8c00000aEMWm" name="00N8c00000aEMWm" type="text" required />
          </div>

          <div class="form-group">
            <label for="00N8c00000aEMWr">What will these books be used for?* (Hold Ctrl to select multiple)</label>
            <select name="00N8c00000aEMWr" multiple required>
              <option value="Building Home Libraries">Building Home Libraries</option>
              <option value="Classroom Libraries">Classroom Libraries</option>
              <option value="School Library Support">School Library Support</option>
              <option value="Book Giveaway">Book Giveaway</option>
              <option value="Literacy or Curriculum Night/Fair">Literacy or Curriculum Night/Fair</option>
              <option value="Summer Reading/Summer Slide">Summer Reading/Summer Slide</option>
              <option value="Other">Other</option>
            </select>
          </div>

          <div class="form-group">
            <label for="00N8c00000aEJos">How many books per child?* (Numbers only)</label>
            <input id="00N8c00000aEJos" name="00N8c00000aEJos" type="text" required />
          </div>

          <h2 class="section-title">Pickup & Distribution Schedule</h2>

          <div class="form-row">
            <div class="form-group">
              <label for="pickupDate">Pickup Date* (Monday-Thursday only)</label>
              <input id="pickupDate" type="date" required />
            </div>
            <div class="form-group">
              <label for="pickupTime">Pickup Time* (9:30 AM - 3:30 PM)</label>
              <input id="pickupTime" type="time" min="09:30" max="15:30" required />
            </div>
          </div>

          <div class="form-group">
            <label for="expectedDateInput">Expected Book Distribution Date*</label>
            <input id="expectedDateInput" type="date" required />
          </div>

          <div class="form-group">
            <label for="00N8c00000aEJp2">Book Selection Type*</label>
            <select id="00N8c00000aEJp2" name="00N8c00000aEJp2" required>
              <option value="">--Select an option--</option>
              <option value="Self-Select">Self-Select (I'll choose my own books)</option>
              <option value="Pre-Boxed">Pre-Boxed (Staff will select books for me)</option>
            </select>
          </div>

          <button type="submit" class="submit-btn">Submit Request</button>
        </form>
      </div>
    </div>

    <script>
      function showAlert(msg) {
        const box = document.getElementById("customAlertBox");
        const text = document.getElementById("customAlertMsg");
        text.textContent = msg;
        box.style.display = "block";

        const overlay = document.createElement("div");
        overlay.id = "customAlertOverlay";
        document.body.appendChild(overlay);
        
        // Update parent height when alert shows
        updateParentHeight();
      }

      function closeAlert() {
        const box = document.getElementById("customAlertBox");
        const overlay = document.getElementById("customAlertOverlay");
        box.style.display = "none";
        if (overlay) overlay.remove();
        
        // Update parent height when alert closes
        updateParentHeight();
      }

      // Function to send height to parent window
      function updateParentHeight() {
        const height = document.documentElement.scrollHeight;
        window.parent.postMessage({ 
          type: 'iframeHeight', 
          height: height 
        }, '*');
      }

      // Update height on load and when content changes
      window.addEventListener('load', updateParentHeight);
      window.addEventListener('resize', updateParentHeight);

      // Create observer to watch for DOM changes
      const observer = new MutationObserver(updateParentHeight);
      observer.observe(document.body, { 
        childList: true, 
        subtree: true, 
        attributes: true 
      });

      (function () {
        const form = document.getElementById("webToLeadForm");
        const pickupDate = document.getElementById("pickupDate");
        const pickupTime = document.getElementById("pickupTime");
        const pickupHidden = document.getElementById("pickupHidden");
        const pickupTimeHidden = document.getElementById("pickupTimeHidden");
        const expectedDateInput = document.getElementById("expectedDateInput");
        const expectedHidden = document.getElementById("expectedHidden");

        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, "0");
        const dd = String(today.getDate()).padStart(2, "0");
        const todayStr = `${yyyy}-${mm}-${dd}`;
        pickupDate.setAttribute("min", todayStr);
        expectedDateInput.setAttribute("min", todayStr);

        function validatePickupDate() {
          const value = pickupDate.value;
          if (!value || value.length !== 10) return;

          const [year, month, day] = value.split("-").map(Number);
          if (year < 1000) return;

          const chosen = new Date(year, month - 1, day, 12, 0, 0);
          const todayMidnight = new Date(today.getFullYear(), today.getMonth(), today.getDate());
          const chosenMidnight = new Date(year, month - 1, day);

          if (chosenMidnight < todayMidnight) {
            showAlert("Pick-up date must be today or in the future.");
            pickupDate.value = "";
            return;
          }

          const dayOfWeek = chosen.getDay();
          if (dayOfWeek === 0 || dayOfWeek === 5 || dayOfWeek === 6) {
            showAlert("Pick-up days are Monday through Thursday only.");
            pickupDate.value = "";
          }
        }

        function validatePickupTime() {
          const timeVal = pickupTime.value;
          if (!timeVal || timeVal.length !== 5) return;

          const [hours, minutes] = timeVal.split(":").map(Number);
          const totalMinutes = hours * 60 + minutes;
          const minMinutes = 9 * 60 + 30;
          const maxMinutes = 15 * 60 + 30;

          if (totalMinutes < minMinutes || totalMinutes > maxMinutes) {
            showAlert("Pick-up time must be between 9:30 AM and 3:30 PM.");
            pickupTime.value = "";
          }
        }

        pickupDate.addEventListener("change", validatePickupDate);
        pickupDate.addEventListener("blur", validatePickupDate);
        pickupTime.addEventListener("change", validatePickupTime);
        pickupTime.addEventListener("blur", validatePickupTime);

        form.addEventListener("submit", function (e) {
          const dateVal = pickupDate.value;
          const timeVal = pickupTime.value;

          if (!dateVal || !timeVal) {
            e.preventDefault();
            showAlert("Please select both pickup date and time.");
            return;
          }

          const combined = new Date(`${dateVal}T${timeVal}`);
          const month = combined.getMonth() + 1;
          const day = combined.getDate();
          const year = combined.getFullYear();

          let hours = combined.getHours();
          const minutes = String(combined.getMinutes()).padStart(2, "0");
          const ampm = hours >= 12 ? "PM" : "AM";
          hours = hours % 12 || 12;

          pickupHidden.value = `${month}/${day}/${year}, ${hours}:${minutes} ${ampm}`;
          pickupTimeHidden.value = `${hours}:${minutes} ${ampm}`;

          const expectedVal = expectedDateInput.value;
          if (expectedVal) {
            const [eyear, emonth, eday] = expectedVal.split("-");
            expectedHidden.value = `${emonth}/${eday}/${eyear}`;
          }
        });
      })();
    </script>
  </body>
</html>
